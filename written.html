<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬”è¯•æŒ‘æˆ˜ (è¯Šæ–­æ¨¡å¼)</title>
    <style>
        body { font-family: sans-serif; background: #fff3e0; padding: 20px; }
        .box { background: white; padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .error-log { background: #333; color: #ff5252; padding: 15px; border-radius: 5px; font-family: monospace; text-align: left; margin-top: 20px; display: none; }
        button { padding: 10px 20px; font-size: 16px; background: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .q-card { border: 1px solid #ddd; padding: 10px; margin: 10px 0; border-radius: 5px; text-align: left; }
    </style>
</head>
<body>

<a href="index.html">ğŸ  è¿”å›å¤§å…</a>

<div class="box">
    <h1>ğŸ› ï¸ ç¬”è¯•ç³»ç»Ÿè¯Šæ–­</h1>
    <p>å¦‚æœä¸‹æ–¹èƒ½æ˜¾ç¤ºé¢˜ç›®ï¼Œè¯´æ˜æ‚¨çš„æµè§ˆå™¨æ²¡é—®é¢˜ï¼Œæ˜¯<b>æ–‡ä»¶è·¯å¾„</b>é”™äº†ã€‚</p>
    
    <div id="console" class="error-log"></div>

    <div id="quiz-area">
        <h3>å½“å‰çŠ¶æ€ï¼š<span id="status">ç­‰å¾…åŠ è½½...</span></h3>
        <button onclick="startDiagnostic()">ğŸ‘‰ ç‚¹å‡»è¿™é‡ŒåŠ è½½ Unit 1 (å†…ç½®æ•°æ®)</button>
        <br><br>
        <button onclick="loadFileMode()" style="background:#2196f3">ğŸ‘‰ ç‚¹å‡»è¿™é‡ŒåŠ è½½ Unit 3 (å¤–éƒ¨æ–‡ä»¶)</button>
    </div>
</div>

<div id="questions-container"></div>

<script>
    // 1. é”™è¯¯æ•æ‰å™¨
    window.onerror = function(msg, url, line) {
        const log = document.getElementById('console');
        log.style.display = 'block';
        log.innerHTML += `âŒ å‘ç”Ÿé”™è¯¯: ${msg}\nè¡Œå·: ${line}\n----------------\n`;
        document.getElementById('status').innerText = "ç³»ç»Ÿå´©æºƒ ğŸ˜±";
        return false;
    };

    // 2. å†…ç½®æ•°æ® (Unit 1 Backup)
    const INTERNAL_DATA = {
        title: "Unit 1 (å†…ç½®å¤‡ä»½)",
        questions: [
            { qNum: 1, text: "æµ‹è¯•é¢˜ï¼šå¬å½•éŸ³é€‰å›¾ç‰‡", type: "select", options: ["A", "B", "C"], correct: "A" },
            { qNum: 2, text: "æµ‹è¯•é¢˜ï¼šNice to meet you", type: "select", options: ["ä½ å¥½", "å†è§"], correct: "ä½ å¥½" }
        ]
    };

    // 3. æ¨¡å¼ä¸€ï¼šåŠ è½½å†…ç½®æ•°æ®
    function startDiagnostic() {
        try {
            renderQuiz(INTERNAL_DATA);
            document.getElementById('status').innerText = "âœ… å†…ç½®æ•°æ®åŠ è½½æˆåŠŸï¼(è¯´æ˜ä»£ç é€»è¾‘æ˜¯å¥½çš„)";
        } catch (e) {
            window.onerror(e.message, "script", 0);
        }
    }

    // 4. æ¨¡å¼äºŒï¼šå°è¯•åŠ è½½æ‚¨çš„ u3_l1.js æ–‡ä»¶
    function loadFileMode() {
        document.getElementById('status').innerText = "â³ æ­£åœ¨å°è¯•è¯»å– data/written/u3_l1.js ...";
        
        // å®šä¹‰æ¥æ”¶å™¨
        window.LOAD_QUIZ = function(data) {
            renderQuiz(data);
            document.getElementById('status').innerText = "ğŸ‰ å¤–éƒ¨æ–‡ä»¶åŠ è½½æˆåŠŸï¼(è¯´æ˜è·¯å¾„æ˜¯å¯¹çš„)";
        };

        // åˆ›å»ºè„šæœ¬åŠ è½½
        const script = document.createElement('script');
        script.src = "data/written/u3_l1.js"; // ğŸ‘ˆ è¿™é‡Œæ˜¯å…³é”®è·¯å¾„
        
        script.onerror = function() {
            const log = document.getElementById('console');
            log.style.display = 'block';
            log.innerHTML += `âŒ æ— æ³•æ‰¾åˆ°æ–‡ä»¶: data/written/u3_l1.js\nè¯·æ£€æŸ¥ï¼š\n1. æ–‡ä»¶å¤¹åå­—æ˜¯ä¸æ˜¯ written (å°å†™)?\n2. æ–‡ä»¶åæ˜¯ä¸æ˜¯ u3_l1.js?\n`;
            document.getElementById('status').innerText = "âŒ æ–‡ä»¶æœªæ‰¾åˆ°";
        };
        
        document.body.appendChild(script);
    }

    // 5. æ¸²æŸ“å‡½æ•°
    function renderQuiz(data) {
        const div = document.getElementById('questions-container');
        div.innerHTML = `<div class="box"><h2>${data.title}</h2></div>`;
        data.questions.forEach(q => {
            div.innerHTML += `
                <div class="box q-card">
                    <b>Q${q.qNum}:</b> ${q.text}<br>
                    (è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ˜¾ç¤º)
                </div>
            `;
        });
    }
</script>

</body>
</html>
